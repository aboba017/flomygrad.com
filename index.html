<script>lang="en"</script>
<script> localize = JSON.parse(`{"homigrad_title":"Flomygrad - Лучший сервер в Garry's mod","homigrad_subtitle":"Множество режимов в одном сервере и не только  !","text_rules":"Rules","text_ierarhy":"Hierarchy","text_tableroles":"Table roles","text_usefullinks":"Useful links","text_join":"Присоеденится","text_join_discord":"Присоеденяйся к нашему сообществу!","text_us_media":"Our social networks","text_us_forum":"Our forum","https://ierarhy_link/":"https://docs.google.com/document/d/1-lnYVjUy5LqyJL0YoY5REwHBq3N_JOgdNDSwCIeefRs/edit?usp=sharing","https://tableroles_link/":"https://docs.google.com/spreadsheets/d/1VzNKUNJV4FVhGayi1GLvIHVaOtiFNbSa9zK-2G-dgNA/edit?usp=sharing","discord_iframe":"https://discord.com/widget?id=1385174596537286768&theme=dark","https://discord_link/":"https://discord.gg/R99agsa2ND","tiktok_logo":"/resource/icon-usa.png","https://tiktok_link/":"https://www.tiktok.com/@homigradenglish","tiktok_name":"homigradenglish","tiktok_name2":"HOMIGRAD ENG","youtube_title":"Youtube <b style='font-weight: 100;'> - slices, gameplay, guides.</b>","tiktok_title":"TikTok <b style='font-weight: 100;'> - funny moments from the games</b>"}`) </script><html>
    <meta charset="UTF-8">
    <head>
        <link rel="stylesheet" href="resource/main.css">
        <link rel="stylesheet" href="resource/main_servers.css">
        <link rel="stylesheet" href="resource/icons.css">
        <link rel="icon" href="resource/fav.ico">

        <meta property="og:site_name" content="Flomygrad - Лучший сервер в Garry's mod">
        <meta property="og:title" content="Flomygrad - Лучший сервер в Garry's mod">
        <meta property="og:image" content="https://homigrad.com/resource/fav.ico">
        <meta name="description" content="Flomygrad - This servers network for Garry's mod, many minigames and maps on one server!">

        <title>Flomygrad</title>

    <header>
        <div class="main">
            <div class="icon"></div>
            <p><a class="light" href="index.html">Flomygrad</a></p>
            <ul>
            </ul>
        </div>
    </header>

    <body>
        <div style="
        height: 720px;
        width: 100%;
        overflow: hidden;
        ">
            <div style="
            overflow: hidden;
            position: relative;
            width: 100%;
            height: 100%;
            opacity: 0.5;
            background-color: black;
            ">
                <video pip="false" autoplay="" muted="" loop="" playsinline="" style="
                width: 1980px;
                height: 1280px;
                filter: blur(3px);
                position: relative;
                left: 50%;
                top: 50%;
                transform: translate(-50%,-50%);
                ">
                <source src="resource/promo.webm" type="video/mp4">
                </video>
            </div>
                <div style="
                position: relative;
                width: 75%;
                height: 75%;
                top: -87.5%;
                left: 12.5%;
                ">
                    <h1 style="font-size: 4em;">homigrad_title</h1>
                    <p style="font-size: 2em; padding-top: 1em;">homigrad_subtitle</p>
                </div>
            </div>

        <div style="
            width: 100%;
            height: 900px;
            overflow: hidden;
        ">
            <div class="background_blur" style="
                width: 100%;
                height: 100%;

                filter: blur(10px);
                background-image: url('resource/background_discord.png');
                background-position: center;
                background-size: cover;
                opacity: 0.5;
            "></div>
            <div style="
                width: 100%;
                height: 100%;
                position: relative;
                top: -100%;

                display: flex;
                flex-direction: column;
            ">
                <h1 style="
                    width: 75%;
                    left: 12.5%;
                    position: relative;

                    font-size: 4em;
                    text-align: center;
                    margin-top: 1em;
                    margin-bottom: 1em;
                ">text_join_discord</h1>

                <div style="
                    width: 75%;
                    left: 12.5%;
                    height: 100%;
                    position: relative;
                    display: flex;
                    justify-content: center;
                    margin-bottom: 4em;
                ">
                    <iframe id="discord" style="width: 50%; min-width: 500px; height: 100%; position: relative;" src="" allowtransparency="true" frameborder="0" sandbox="allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts"></iframe>
                </div>

                <a class="light" style="
                    width: 75%;
                    left: 12.5%;
                    position: relative;
                    font-size: 4em;
                    justify-content: center;
                    align-items: center;
                    text-align: center;
                    margin-bottom: 1em;
                " href="https://discord_link/">text_join</a>
            </div>
        </div>

        <!-- НОВЫЙ РАЗДЕЛ: Что такое хомиград? -->
        <div style="
            width: 100%;
            min-height: 400px;
            background-color: rgba(17, 17, 21, 0.95);
            padding: 50px 0;
            display: flex;
            flex-direction: column;
            align-items: center;
        ">
            <div style="
                width: 75%;
                max-width: 20000px;
            ">
                <h1 style="
                    font-size: 3.5em;
                    text-align: center;
                    margin-bottom: 40px;
                    color: #fff;
                ">Что такое хомиград?</h1>
                    <p>Сервер с разными режимами, которые сменяются из раза в раз и которые не будут вас выводить с сума и надоедасть. Множество игровых механиков, карт, оружий, и много чего другого. Заходи чтоб в этом убедится! Обновление и новости о сервере будут находится в дискорд сервере который указан сверху (в будущем я переделаю сайт и обновление будут на сайт оповещатся)</p>
                </div>
            </div>
        </div>

    </body>

    <footer style="
    height: 50px;
    background: rgba(20,20,20,0.7);
    display: flex;
    align-items: center;
    justify-content: center;
    color: #aaa;
    ">
        <p>by aboba</p>
    </footer>

    <script src="resource/main.js"></script>
    
    <script>
        let discord = document.getElementById("discord")
        discord.src = localize.discord_iframe

        let serversList = document.getElementById("servers")
        let servername = document.getElementById("servername")
        let serverip = document.getElementById("serverip")
        let serverflag = document.getElementById("serverflag")
        let players = document.getElementById("players")
        let buttonJoin = document.getElementById("button_join")

        let removeAll = async (parent) => {
            for (let child of parent.children) {parent.removeChild(child)}

            if (parent.children.length != 0) {return removeAll(parent)}//долбаёбы ебаные блядь.

            return true
        }

        async function showServerInfo(info) {
            servername.innerHTML = info.name
            serverip.innerHTML = info.ip
            serverflag.style.backgroundImage = 'url("/resource/flags16/' + (info.location != "" && info.location || info.lang) + '.png")'

            await removeAll(players)

            for (ply of info.players) {
                let tr = document.createElement("tr")
                players.appendChild(tr)
                tr.classList.add("li")

                let name = document.createElement("th")
                tr.appendChild(name)
                name.innerHTML = ply.name

                let steamid = document.createElement("td")
                tr.appendChild(steamid)
                steamid.innerHTML = ply.steamid

                let group = document.createElement("td")
                tr.appendChild(group)
                group.style = "flex: 0.5;"
                group.innerHTML = ply.group

                let ping = document.createElement("td")
                tr.appendChild(ping)
                ping.style = "flex: 0.25;"
                ping.innerHTML = ply.ping
            }

            buttonJoin.href = "steam://connect/" + info.ip
        }

        async function updateCountServers() {
            let showFirstInfo

            let servers = await getFetch("status/count")

            let newServers = {}
            for (let id in servers) {newServers[servers[id]] = {}}
            servers = newServers

            await removeAll(serversList)
            
            async function build() {
                await removeAll(serversList)
                
                let list = []

                for (id in servers) {
                    let server = servers[id]
                    
                    if (server.info) {list.push(server)}
                }

                list.sort((a,b) => a.name > b.name)
                
                for (server of list) {
                    let info = server.info

                    let tr = document.createElement("button")
                    serversList.appendChild(tr)
                    tr.classList.add("li")

                    tr.onclick = () => showServerInfo(info)

                    let flag = document.createElement("div")
                    tr.appendChild(flag)
                    flag.style = `
                        width: 30px;
                        height: 30px;

                        background-size: 16px;
                        background-repeat: no-repeat;
                        background-position: center center;
                        background-image: url("/resource/loading.png");
                    `
                    flag.style.backgroundImage = 'url("/resource/flags16/' + (info.location != "" && info.location || info.lang) + '.png")'

                    let name = document.createElement("th")
                    tr.appendChild(name)
                    name.style = "text-align: left;"
                    name.innerHTML = info.name
 
                    let map = document.createElement("td")
                    tr.appendChild(map)
                    map.style = "text-align: center; flex: 0.5;"
                    map.innerHTML = info.map

                    let plyCount = document.createElement("td")
                    tr.appendChild(plyCount)
                    plyCount.style = "text-align: center; width: 6em; flex: 0 0 auto;"
                    plyCount.innerHTML = info.players.length + " / " + info.maxPlayers

                    let button = document.createElement("div")
                    tr.appendChild(button)
                    button.style = `
                        width: 30px;
                        height: 30px;

                        background-size: 18px;
                    `
                }
            }

            let iterations = servers.length

            for (let id in servers) {
                let server = servers[id]
                --iterations//нихуясебе

                async function get() {
                    let info = await getFetch("status/" + id)
                    server.info = info

                    if (!showFirstInfo) {showFirstInfo = true; showServerInfo(info)}
                    if (!iterations) {build()}
                }

                get()
            }
        }

        updateCountServers()

        let refresh_servers = document.getElementById("refresh_servers")

        refresh_servers.onclick = async () => {
            refresh_servers.style.backgroundImage = 'url("/resource/loading.png")'
            refresh_servers.classList.add("rotate")

            await updateCountServers()

            refresh_servers.style.backgroundImage = 'url("/resource/refresh.png")'
            refresh_servers.classList.remove("rotate")
        }
    </script>
</html>

    <script>
        function language_setup(list) {
            for (element of list) {
                let encrypt = localize[element.innerHTML]
                if (encrypt) element.innerHTML = encrypt

                if (element.href) {
                    encrypt = localize[element.href]
                    if (encrypt) element.href = encrypt
                }

                if (element.title) {
                    encrypt = localize[element.title]
                    if (encrypt) element.title = encrypt
                }
            }
        }

        language_setup(document.getElementsByTagName("a"))
        language_setup(document.getElementsByTagName("p"))
        language_setup(document.getElementsByTagName("h1"))
        language_setup(document.getElementsByTagName("button"))
    </script>
    
    <script>
        let supportLanguages = JSON.parse('{"ru":true,"en":true}')

        let select = document.getElementById("language")

        for (let lang2 in supportLanguages) {
            let option = document.createElement("option")
            select.appendChild(option)

            option.value = lang2
            option.innerHTML = lang2

            if (lang2 == lang) {option.selected = true}
        }

        setLanguage = (value) => {
            document.cookie = 'lang=' + event.target.value + '; path=/'
        }
            
        select.addEventListener("change",(event) => {
            setLanguage(event.target.value + '; path=/;')

            window.location.reload()
        })
    </script>